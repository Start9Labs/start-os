{
  "db": "SQLite",
  "06f2423bb5f9b9520cc3cf010132a5cb6157cccdcdb6b8a5695261fa7434f176": {
    "query": "INSERT INTO ssh_keys (fingerprint, openssh_pubkey, created_at) VALUES (?, ?, datetime('now'))",
    "describe": {
      "columns": [],
      "parameters": {
        "Right": 2
      },
      "nullable": []
    }
  },
  "118d59de5cf930d5a3b5667b2220e9a3d593bd84276beb2b76c93b2694b0fd72": {
    "query": "INSERT INTO session (id, user_agent, metadata) VALUES (?, ?, ?)",
    "describe": {
      "columns": [],
      "parameters": {
        "Right": 3
      },
      "nullable": []
    }
  },
  "3502e58f2ab48fb4566d21c920c096f81acfa3ff0d02f970626a4dcd67bac71d": {
    "query": "SELECT tor_key FROM account",
    "describe": {
      "columns": [
        {
          "name": "tor_key",
          "ordinal": 0,
          "type_info": "Blob"
        }
      ],
      "parameters": {
        "Right": 0
      },
      "nullable": [
        false
      ]
    }
  },
  "3e57a0e52b69f33e9411c13b03a5d82c5856d63f0375eb4c23b255a09c54f8b1": {
    "query": "SELECT key FROM tor WHERE package = ? AND interface = ?",
    "describe": {
      "columns": [
        {
          "name": "key",
          "ordinal": 0,
          "type_info": "Blob"
        }
      ],
      "parameters": {
        "Right": 2
      },
      "nullable": [
        false
      ]
    }
  },
  "4691e3a2ce80b59009ac17124f54f925f61dc5ea371903e62cdffa5d7b67ca96": {
    "query": "SELECT * FROM session WHERE logged_out IS NULL OR logged_out > CURRENT_TIMESTAMP",
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Text"
        },
        {
          "name": "logged_in",
          "ordinal": 1,
          "type_info": "Datetime"
        },
        {
          "name": "logged_out",
          "ordinal": 2,
          "type_info": "Datetime"
        },
        {
          "name": "last_active",
          "ordinal": 3,
          "type_info": "Datetime"
        },
        {
          "name": "user_agent",
          "ordinal": 4,
          "type_info": "Text"
        },
        {
          "name": "metadata",
          "ordinal": 5,
          "type_info": "Text"
        }
      ],
      "parameters": {
        "Right": 0
      },
      "nullable": [
        false,
        false,
        true,
        false,
        true,
        false
      ]
    }
  },
  "530192a2a530ee6b92e5b98e1eb1bf6d1426c7b0cb2578593a367cb0bf2c3ca8": {
    "query": "UPDATE certificates SET priv_key_pem = ?, certificate_pem = ?, updated_at = datetime('now') WHERE lookup_string = ?",
    "describe": {
      "columns": [],
      "parameters": {
        "Right": 3
      },
      "nullable": []
    }
  },
  "5c47da44b9c84468e95a13fc47301989900f130b3b5899d1ee6664df3ed812ac": {
    "query": "INSERT INTO certificates (id, priv_key_pem, certificate_pem, lookup_string, created_at, updated_at) VALUES (0, ?, ?, NULL, datetime('now'), datetime('now'))",
    "describe": {
      "columns": [],
      "parameters": {
        "Right": 2
      },
      "nullable": []
    }
  },
  "629be61c3c341c131ddbbff0293a83dbc6afd07cae69d246987f62cf0cc35c2a": {
    "query": "SELECT password FROM account",
    "describe": {
      "columns": [
        {
          "name": "password",
          "ordinal": 0,
          "type_info": "Text"
        }
      ],
      "parameters": {
        "Right": 0
      },
      "nullable": [
        false
      ]
    }
  },
  "63785dc5f193ea31e6f641a910c75857ccd288a3f6e9c4f704331531e4f0689f": {
    "query": "UPDATE session SET last_active = CURRENT_TIMESTAMP WHERE id = ? AND logged_out IS NULL OR logged_out > CURRENT_TIMESTAMP",
    "describe": {
      "columns": [],
      "parameters": {
        "Right": 1
      },
      "nullable": []
    }
  },
  "6440354d73a67c041ea29508b43b5f309d45837a44f1a562051ad540d894c7d6": {
    "query": "DELETE FROM ssh_keys WHERE fingerprint = ?",
    "describe": {
      "columns": [],
      "parameters": {
        "Right": 1
      },
      "nullable": []
    }
  },
  "6c96d76bffcc5f03290d8d8544a58521345ed2a843a509b17bbcd6257bb81821": {
    "query": "SELECT priv_key_pem, certificate_pem FROM certificates WHERE id = 1;",
    "describe": {
      "columns": [
        {
          "name": "priv_key_pem",
          "ordinal": 0,
          "type_info": "Text"
        },
        {
          "name": "certificate_pem",
          "ordinal": 1,
          "type_info": "Text"
        }
      ],
      "parameters": {
        "Right": 0
      },
      "nullable": [
        false,
        false
      ]
    }
  },
  "70a100abc8ca04ffc559ca16460d4fd4c65aa34952ade2681491f0b44dc1aaa1": {
    "query": "INSERT OR REPLACE INTO account (id, password, tor_key) VALUES (?, ?, ?)",
    "describe": {
      "columns": [],
      "parameters": {
        "Right": 3
      },
      "nullable": []
    }
  },
  "7d548d2472fa3707bd17364b4800e229b9c2b1c0a22e245bf4e635b9b16b8c24": {
    "query": "INSERT INTO certificates (priv_key_pem, certificate_pem, lookup_string, created_at, updated_at) VALUES (?, ?, ?, datetime('now'), datetime('now'))",
    "describe": {
      "columns": [],
      "parameters": {
        "Right": 3
      },
      "nullable": []
    }
  },
  "8595651866e7db772260bd79e19d55b7271fd795b82a99821c935a9237c1aa16": {
    "query": "SELECT interface, key FROM tor WHERE package = ?",
    "describe": {
      "columns": [
        {
          "name": "interface",
          "ordinal": 0,
          "type_info": "Text"
        },
        {
          "name": "key",
          "ordinal": 1,
          "type_info": "Blob"
        }
      ],
      "parameters": {
        "Right": 1
      },
      "nullable": [
        false,
        false
      ]
    }
  },
  "8c87b09f997838b7e5be48ebb202d97eb9d512a51c6e67b1fb7df33abd79a0af": {
    "query": "-- Add migration script here\nCREATE TABLE IF NOT EXISTS tor\n(\n    package     TEXT NOT NULL,\n    interface   TEXT NOT NULL,\n    key         BLOB NOT NULL CHECK (length(key) = 64),\n    PRIMARY KEY (package, interface)\n);\nCREATE TABLE IF NOT EXISTS session\n(\n    id         TEXT NOT NULL PRIMARY KEY,\n    logged_in TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    logged_out TIMESTAMP,\n    last_active TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    user_agent TEXT,\n    metadata   TEXT NOT NULL DEFAULT 'null'\n);\nCREATE TABLE IF NOT EXISTS account\n(\n    id INTEGER PRIMARY KEY CHECK (id = 0),\n    password TEXT NOT NULL,\n    tor_key BLOB NOT NULL CHECK (length(tor_key) = 64)\n);\nCREATE TABLE IF NOT EXISTS ssh_keys\n(\n    fingerprint     TEXT NOT NULL,\n    openssh_pubkey  TEXT NOT NULL,\n    created_at      TEXT NOT NULL,\n    PRIMARY KEY (fingerprint)\n);\nCREATE TABLE IF NOT EXISTS certificates\n(\n    id INTEGER PRIMARY KEY, -- Root = 0, Int = 1, Other = 2..\n    priv_key_pem TEXT NOT NULL,\n    certificate_pem TEXT NOT NULL,\n    lookup_string TEXT UNIQUE,\n    created_at TEXT,\n    updated_at TEXT\n);",
    "describe": {
      "columns": [],
      "parameters": {
        "Right": 0
      },
      "nullable": []
    }
  },
  "9496e17a73672ac3675e02efa7c4bf8bd479b866c0d31fa1e3a85ef159310a57": {
    "query": "SELECT priv_key_pem, certificate_pem FROM certificates WHERE lookup_string = ?",
    "describe": {
      "columns": [
        {
          "name": "priv_key_pem",
          "ordinal": 0,
          "type_info": "Text"
        },
        {
          "name": "certificate_pem",
          "ordinal": 1,
          "type_info": "Text"
        }
      ],
      "parameters": {
        "Right": 1
      },
      "nullable": [
        false,
        false
      ]
    }
  },
  "a1cbaac36d8e14c8c3e7276237c4824bff18861f91b0b08aa5791704c492acb7": {
    "query": "INSERT INTO certificates (id, priv_key_pem, certificate_pem, lookup_string, created_at, updated_at) VALUES (1, ?, ?, NULL, datetime('now'), datetime('now'))",
    "describe": {
      "columns": [],
      "parameters": {
        "Right": 2
      },
      "nullable": []
    }
  },
  "a6b0c8909a3a5d6d9156aebfb359424e6b5a1d1402e028219e21726f1ebd282e": {
    "query": "SELECT fingerprint, openssh_pubkey, created_at FROM ssh_keys",
    "describe": {
      "columns": [
        {
          "name": "fingerprint",
          "ordinal": 0,
          "type_info": "Text"
        },
        {
          "name": "openssh_pubkey",
          "ordinal": 1,
          "type_info": "Text"
        },
        {
          "name": "created_at",
          "ordinal": 2,
          "type_info": "Text"
        }
      ],
      "parameters": {
        "Right": 0
      },
      "nullable": [
        false,
        false,
        false
      ]
    }
  },
  "d5117054072476377f3c4f040ea429d4c9b2cf534e76f35c80a2bf60e8599cca": {
    "query": "SELECT openssh_pubkey FROM ssh_keys",
    "describe": {
      "columns": [
        {
          "name": "openssh_pubkey",
          "ordinal": 0,
          "type_info": "Text"
        }
      ],
      "parameters": {
        "Right": 0
      },
      "nullable": [
        false
      ]
    }
  },
  "d79d608ceb862c15b741a6040044c6dd54a837a3a0c5594d15a6041c7bc68ea8": {
    "query": "INSERT OR IGNORE INTO tor (package, interface, key) VALUES (?, ?, ?)",
    "describe": {
      "columns": [],
      "parameters": {
        "Right": 3
      },
      "nullable": []
    }
  },
  "de2a5e90798d606047ab8180c044baac05469c0cdf151316bd58ee8c7196fdef": {
    "query": "SELECT * FROM ssh_keys WHERE fingerprint = ?",
    "describe": {
      "columns": [
        {
          "name": "fingerprint",
          "ordinal": 0,
          "type_info": "Text"
        },
        {
          "name": "openssh_pubkey",
          "ordinal": 1,
          "type_info": "Text"
        },
        {
          "name": "created_at",
          "ordinal": 2,
          "type_info": "Text"
        }
      ],
      "parameters": {
        "Right": 1
      },
      "nullable": [
        false,
        false,
        false
      ]
    }
  },
  "ed848affa5bf92997cd441e3a50b3616b6724df3884bd9d199b3225e0bea8a54": {
    "query": "SELECT priv_key_pem, certificate_pem FROM certificates WHERE id = 0;",
    "describe": {
      "columns": [
        {
          "name": "priv_key_pem",
          "ordinal": 0,
          "type_info": "Text"
        },
        {
          "name": "certificate_pem",
          "ordinal": 1,
          "type_info": "Text"
        }
      ],
      "parameters": {
        "Right": 0
      },
      "nullable": [
        false,
        false
      ]
    }
  }
}