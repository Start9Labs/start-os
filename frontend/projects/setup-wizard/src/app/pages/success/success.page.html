<canvas #canvas> Your browser does not support the canvas element. </canvas>
<ion-content [scrollEvents]="true" (ionScrollEnd)="checkBottom()">
  <!-- kiosk mode  -->
  <ng-container *ngIf="isKiosk; else notKiosk">
    <ion-card>
      <ion-card-header class="ion-text-center" color="success">
        <ion-icon
          style="font-size: 80px"
          name="checkmark-circle-outline"
        ></ion-icon>
        <ion-card-title>Setup Complete!</ion-card-title>
        <ion-card-subtitle>
          <b>You will be redirected momentarily</b>
        </ion-card-subtitle>
        <br />
      </ion-card-header>
    </ion-card>
  </ng-container>
  <!-- not kiosk -->
  <ng-template #notKiosk>
    <ion-content>
      <ion-grid [fixed]="true">
        <div class="">
          <ion-row>
            <ion-col size-xs="12" class="ion-text-center">
              <div class="inline">
                <ion-icon name="checkmark-circle-outline"></ion-icon>
                <h1>Setup Complete!</h1>
              </div>
              <h3>
                <span *ngIf="recoverySource && recoverySource.type === 'backup'"
                  >You can now safely unplug your backup drive.</span
                >
                <span
                  *ngIf="recoverySource && recoverySource.type === 'migrate'"
                  >You can now safely unplug your old drive.</span
                >
                &nbsp;Download this page for your records.
              </h3>
              <p>
                NOTE: embassy.local was for setup purposes only. It will no
                longer be accessible.
              </p>
              <ion-button (click)="download()">
                Save this page
                <ion-icon slot="end" name="download-outline"></ion-icon>
              </ion-button>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col class="ion-text-center">
              <h1>Access your Embassy</h1>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col size-sm="12" size-md="6">
              <ion-card>
                <h2>From home (LAN)</h2>
                <p>
                  Visit the address below when you are connected to the same
                  WiFi or Local Area Network (LAN) as your Embassy:
                </p>
                <ion-item class="ion-padding-top ion-padding-bottom">
                  <ion-label class="ion-text-wrap">
                    <code>
                      <ion-text><b>{{ lanAddress }}</b></ion-text>
                    </code>
                  </ion-label>
                  <ion-button
                    color="light"
                    fill="clear"
                    [href]="lanAddress"
                    target="_blank"
                  >
                    <ion-icon slot="icon-only" name="open-outline"></ion-icon>
                  </ion-button>
                  <ion-button
                    color="light"
                    fill="clear"
                    (click)="copy(lanAddress)"
                  >
                    <ion-icon slot="icon-only" name="copy-outline"></ion-icon>
                  </ion-button>
                </ion-item>
                <div>
                  <h3>Important!</h3>
                  <p>
                    Your browser will warn you that the website is untrusted.
                    You can bypass this warning on most browsers. The warning
                    will go away after you
                    <a
                      href="https://docs.start9.com/latest/user-manual/connecting/connecting-lan"
                      target="_blank"
                      rel="noreferrer"
                      class="inline"
                    >
                      follow the instructions
                      <ion-icon name="open-outline"></ion-icon>
                    </a>
                    to download and trust your Embassy's Root Certificate
                    Authority.
                  </p>
                </div>
                <ion-button style="margin-top: 24px" (click)="installCert()">
                  Download Root CA
                  <ion-icon slot="end" name="download-outline"></ion-icon>
                </ion-button>
              </ion-card>
            </ion-col>
            <ion-col size-sm="12" size-md="6">
              <ion-card>
                <h2>On the go (TOR)</h2>
                <p>Visit the address below when you are away from home:</p>
                <ion-item class="ion-padding-top ion-padding-bottom">
                  <ion-label class="ion-text-wrap">
                    <code>
                      <ion-text><b>{{ torAddress }}</b></ion-text>
                    </code>
                  </ion-label>
                  <ion-button
                    color="light"
                    fill="clear"
                    [href]="lanAddress"
                    target="_blank"
                  >
                    <ion-icon slot="icon-only" name="open-outline"></ion-icon>
                  </ion-button>
                  <ion-button
                    color="light"
                    fill="clear"
                    (click)="copy(torAddress)"
                  >
                    <ion-icon slot="icon-only" name="copy-outline"></ion-icon>
                  </ion-button>
                </ion-item>
                <div>
                  <h3>Important!</h3>
                  <p>
                    This address will only work from a Tor-enabled browser.
                    Follow the
                    <a
                      href="https://docs.start9.com/latest/user-manual/connecting/connecting-tor"
                      target="_blank"
                      rel="noreferrer"
                      class="inline"
                    >
                      instructions
                      <ion-icon name="open-outline"></ion-icon>
                    </a>
                    to get setup.
                  </p>
                </div>
              </ion-card>
            </ion-col>
          </ion-row>
        </div>
      </ion-grid>
    </ion-content>

    <!-- scroll down -->
    <div
      [ngStyle]="{
          position: 'fixed',
          bottom: isOnBottom ? '-42px' : '24px',
          transition: 'bottom 0.15s ease-out 0s',
          right: '50%',
          width: '120px',
          'margin-right': '-60px',
          'z-index': '1000'
        }"
    >
      <ion-button color="warning" (click)="scrollToBottom()">
        More
        <ion-icon slot="end" name="chevron-down"></ion-icon>
      </ion-button>
    </div>
  </ng-template>
</ion-content>
