<ng-container *ngIf="pkgPlus$ | async as pkgPlus">
  <!-- header -->
  <app-show-header [pkg]="pkgPlus.pkg"></app-show-header>

  <!-- content -->
  <ion-content *ngIf="pkgPlus.pkg as pkg" class="ion-padding with-widgets">
    <!-- ** installing, updating, restoring ** -->
    <ng-container *ngIf="showProgress(pkg); else installed">
      <app-show-progress
        [phases]="pkg.stateInfo.installingInfo.progress.phases"
      ></app-show-progress>
    </ng-container>

    <!-- Installed -->
    <ng-template #installed>
      <ion-item-group *ngIf="pkgPlus.status as status">
        <!-- ** status ** -->
        <app-show-status [pkg]="pkg" [status]="status"></app-show-status>
        <!-- ** installed && !backingUp && !error ** -->
        <ng-container
          *ngIf="isInstalled(pkg) && status.primary !== 'backingUp' && status.primary !== 'error'"
        >
          <!-- ** action requests ** -->
          <app-show-action-requests
            [allPkgs]="pkgPlus.allPkgs"
            [pkg]="pkg"
            [manifest]="pkgPlus.manifest"
          ></app-show-action-requests>
          <!-- ** health checks ** -->
          <app-show-health-checks
            *ngIf="pkg.status.main === 'running'"
            [healthChecks]="pkg.status.health"
          ></app-show-health-checks>
          <!-- ** dependencies ** -->
          <app-show-dependencies
            *ngIf="pkgPlus.dependencies.length"
            [dependencies]="pkgPlus.dependencies"
            [allPkgs]="pkgPlus.allPkgs"
            [pkg]="pkg"
            [pkgId]="pkgPlus.manifest.id"
          ></app-show-dependencies>
          <!-- ** menu ** -->
          <app-show-menu [buttons]="pkg | toButtons"></app-show-menu>
          <!-- ** additional ** -->
          <app-show-additional [pkg]="pkg"></app-show-additional>
        </ng-container>
        <app-show-error
          *ngIf="pkg.status.main === 'error'"
          [manifest]="pkgPlus.manifest"
          [error]="pkg.status"
        ></app-show-error>
      </ion-item-group>
    </ng-template>
  </ion-content>
</ng-container>
